<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Bulk Sender Pro</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <i class="fab fa-whatsapp"></i>
                <span>WhatsApp Bulk Sender Pro</span>
            </div>
            <div class="connection-status">
                <div id="statusIndicator" class="status-dot disconnected"></div>
                <span id="statusText">Disconnected</span>
                <button id="logoutBtn" class="btn btn-sm btn-danger" style="display:none;">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container main-container">
        <!-- QR Code Modal -->
        <div id="qrModal" class="modal">
            <div class="modal-content">
                <h2><i class="fas fa-qrcode"></i> Scan QR Code</h2>
                <p>Open WhatsApp on your phone and scan this code</p>
                <div id="qrCode" class="qr-container">
                    <div class="loader"></div>
                    <p>Generating QR Code...</p>
                </div>
                <div class="qr-instructions">
                    <ol>
                        <li>Open WhatsApp on your phone</li>
                        <li>Tap Menu or Settings</li>
                        <li>Tap Linked Devices</li>
                        <li>Tap "Link a Device"</li>
                        <li>Point your phone at this screen to scan the code</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="dashboard">
                <i class="fas fa-chart-line"></i> Dashboard
            </button>
            <button class="tab-btn" data-tab="contacts">
                <i class="fas fa-address-book"></i> Contacts
            </button>
            <button class="tab-btn" data-tab="campaigns">
                <i class="fas fa-bullhorn"></i> Campaigns
            </button>
            <button class="tab-btn" data-tab="templates">
                <i class="fas fa-file-alt"></i> Templates
            </button>
            <button class="tab-btn" data-tab="api">
                <i class="fas fa-code"></i> API
            </button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <h2><i class="fas fa-chart-line"></i> Dashboard</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalContacts">0</h3>
                        <p>Total Contacts</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-bullhorn"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalCampaigns">0</h3>
                        <p>Total Campaigns</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon purple">
                        <i class="fas fa-paper-plane"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="messagesSent">0</h3>
                        <p>Messages Sent</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon red">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="messagesFailed">0</h3>
                        <p>Messages Failed</p>
                    </div>
                </div>
            </div>

            <div class="card mt-3">
                <h3><i class="fas fa-clock"></i> Recent Activity</h3>
                <div id="recentActivity" class="activity-list">
                    <p class="text-muted">No recent activity</p>
                </div>
            </div>
        </div>

        <!-- Contacts Tab -->
        <div id="contacts" class="tab-content">
            <div class="tab-header">
                <h2><i class="fas fa-address-book"></i> Contacts Management</h2>
                <div class="tab-actions">
                    <button class="btn btn-secondary" onclick="openImportModal()">
                        <i class="fas fa-file-import"></i> Import CSV
                    </button>
                    <button class="btn btn-primary" onclick="openAddContactModal()">
                        <i class="fas fa-plus"></i> Add Contact
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="contactSearch" placeholder="Search contacts...">
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAllContacts"></th>
                            <th>Name</th>
                            <th>Phone</th>
                            <th>Email</th>
                            <th>Tags</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="contactsList">
                        <tr>
                            <td colspan="6" class="text-center">No contacts found</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Campaigns Tab -->
        <div id="campaigns" class="tab-content">
            <div class="tab-header">
                <h2><i class="fas fa-bullhorn"></i> Campaign Management</h2>
                <button class="btn btn-primary" onclick="openCreateCampaignModal()">
                    <i class="fas fa-plus"></i> New Campaign
                </button>
            </div>

            <div class="card">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Status</th>
                            <th>Messages</th>
                            <th>Success Rate</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="campaignsList">
                        <tr>
                            <td colspan="6" class="text-center">No campaigns found</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Templates Tab -->
        <div id="templates" class="tab-content">
            <div class="tab-header">
                <h2><i class="fas fa-file-alt"></i> Message Templates</h2>
                <button class="btn btn-primary" onclick="openCreateTemplateModal()">
                    <i class="fas fa-plus"></i> New Template
                </button>
            </div>

            <div class="templates-grid" id="templatesList">
                <div class="text-center">No templates found</div>
            </div>
        </div>

        <!-- API Tab -->
        <div id="api" class="tab-content">
            <h2><i class="fas fa-code"></i> API Documentation</h2>
            
            <div class="card">
                <h3>Base URL</h3>
                <div class="code-block">
                    <code id="baseUrl">http://localhost:3000</code>
                    <button onclick="copyToClipboard('baseUrl')" class="btn-copy">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
            </div>

            <div class="card">
                <h3>Evolution API Compatibility</h3>
                <p>This system is compatible with Evolution API endpoints</p>
                
                <h4>Send Text Message</h4>
                <div class="code-block">
                    <pre><code>POST /api/evolution/message/sendText/instance1

{
  "number": "5511999999999",
  "textMessage": {
    "text": "Hello from API!"
  }
}</code></pre>
                </div>

                <h4>Send Media Message</h4>
                <div class="code-block">
                    <pre><code>POST /api/evolution/message/sendMedia/instance1

{
  "number": "5511999999999",
  "mediaMessage": {
    "mediaUrl": "https://example.com/image.jpg",
    "caption": "Check this out!"
  }
}</code></pre>
                </div>

                <h4>Get Instance Status</h4>
                <div class="code-block">
                    <pre><code>GET /api/evolution/instance/instance1</code></pre>
                </div>
            </div>

            <div class="card">
                <h3>Standard API Endpoints</h3>
                
                <div class="api-endpoint">
                    <span class="method get">GET</span>
                    <code>/api/contacts</code>
                    <span>Get all contacts</span>
                </div>

                <div class="api-endpoint">
                    <span class="method post">POST</span>
                    <code>/api/contacts</code>
                    <span>Create new contact</span>
                </div>

                <div class="api-endpoint">
                    <span class="method get">GET</span>
                    <code>/api/campaigns</code>
                    <span>Get all campaigns</span>
                </div>

                <div class="api-endpoint">
                    <span class="method post">POST</span>
                    <code>/api/campaigns</code>
                    <span>Create new campaign</span>
                </div>

                <div class="api-endpoint">
                    <span class="method post">POST</span>
                    <code>/api/campaigns/:id/start</code>
                    <span>Start campaign</span>
                </div>

                <div class="api-endpoint">
                    <span class="method get">GET</span>
                    <code>/api/templates</code>
                    <span>Get all templates</span>
                </div>

                <div class="api-endpoint">
                    <span class="method get">GET</span>
                    <code>/api/analytics</code>
                    <span>Get analytics data</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Contact Modal -->
    <div id="addContactModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addContactModal')">&times;</span>
            <h2><i class="fas fa-user-plus"></i> Add New Contact</h2>
            <form id="addContactForm">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Phone (with country code)</label>
                    <input type="text" name="phone" placeholder="5511999999999" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" name="email">
                </div>
                <div class="form-group">
                    <label>Tags (comma separated)</label>
                    <input type="text" name="tags" placeholder="customer, vip">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addContactModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Contact</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Import CSV Modal -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('importModal')">&times;</span>
            <h2><i class="fas fa-file-import"></i> Import Contacts from CSV</h2>
            <form id="importForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label>CSV File</label>
                    <input type="file" name="file" accept=".csv" required>
                    <small>CSV should contain columns: name, phone, email, tags</small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('importModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Import</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Campaign Modal -->
    <div id="createCampaignModal" class="modal">
        <div class="modal-content modal-lg">
            <span class="close" onclick="closeModal('createCampaignModal')">&times;</span>
            <h2><i class="fas fa-bullhorn"></i> Create New Campaign</h2>
            <form id="createCampaignForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label>Campaign Name</label>
                    <input type="text" name="name" required>
                </div>
                
                <div class="form-group">
                    <label>Select Template (Optional)</label>
                    <select id="templateSelect" onchange="loadTemplate()">
                        <option value="">-- Start from scratch --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Message</label>
                    <textarea name="message" rows="6" required placeholder="Use variables: {name}, {phone}, {email}"></textarea>
                    <small>Available variables: {name}, {phone}, {email}</small>
                </div>

                <div class="form-group">
                    <label>Media (Optional)</label>
                    <input type="file" name="media" accept="image/*,video/*,.pdf,.doc,.docx">
                </div>

                <div class="form-group">
                    <label>Select Contacts</label>
                    <div class="contact-selector" id="campaignContactSelector">
                        <div class="text-muted">Loading contacts...</div>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="scheduleCheckbox" onchange="toggleSchedule()">
                        Schedule for later
                    </label>
                </div>

                <div class="form-group" id="scheduleGroup" style="display:none;">
                    <label>Schedule Date & Time</label>
                    <input type="datetime-local" name="scheduled_at">
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('createCampaignModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Campaign</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Template Modal -->
    <div id="createTemplateModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('createTemplateModal')">&times;</span>
            <h2><i class="fas fa-file-alt"></i> Create Message Template</h2>
            <form id="createTemplateForm">
                <div class="form-group">
                    <label>Template Name</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Content</label>
                    <textarea name="content" rows="6" required placeholder="Hello {name}, ..."></textarea>
                    <small>Use {name}, {phone}, {email} as variables</small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('createTemplateModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Template</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/app.js"></script>
</body>
</html>
